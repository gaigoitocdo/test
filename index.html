<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>ANHYEU</title>
  <meta name="description" content="·ª®ng d·ª•ng ƒë·∫∑t l·ªãch Telegram si√™u ƒë·∫πp d√†nh cho anh y√™u">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no,viewport-fit=cover">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <!-- PWA v√† c√°c meta tag kh√°c gi·ªØ nguy√™n -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-title" content="Booking App">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Booking App">
  <meta name="application-name" content="Booking App">
  <meta name="theme-color" content="#0088cc">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://elitegirls.pro">
  <meta property="og:title" content="Booking App">
  <meta property="og:description" content="·ª®ng d·ª•ng Telegram phi√™n b·∫£n c√° nh√¢n h√≥a cho anh y√™u">
  <meta property="og:image" content="/assets/img/icon-512.png">
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://elitegirls.pro">
  <meta property="twitter:title" content="Booking App">
  <meta property="twitter:description" content="ƒê·∫∑t l·ªãch, tr√≤ chuy·ªán ri√™ng, giao di·ªán ƒë·∫πp">
  <meta property="twitter:image" content="/assets/img/icon-512.png">
  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icon-192.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icon-16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icon-32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/assets/img/icon-512.png">
  <link rel="manifest" href="/manifest.json">
  <!-- Telegram WebApp Script -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
(async function ensureTelegramSession() {
  // Ch·ªâ ch·∫°y khi ·ªü trong Telegram WebApp
  const tg = window.Telegram && window.Telegram.WebApp;
  if (!tg) {
    console.info('[TG] Not running inside Telegram WebApp ‚Üí skip bootstrap');
    return;
  }

  tg.ready();
  tg.expand();

  // L·∫•y initData v·ªõi ƒë·ªß fallback
  const fromHash = new URLSearchParams(location.hash.replace(/^#/, ''))
                    .get('tgWebAppData') || '';
  const initData = tg.initData || fromHash || '';

  // Th√™m user (kh√¥ng b·∫Øt bu·ªôc) ƒë·ªÉ server ti·ªán log/kh·ªõp
  const unsafeUser = tg.initDataUnsafe && tg.initDataUnsafe.user || null;

  if (!initData) {
    console.warn('[TG] No initData found ‚Üí backend s·∫Ω tr·∫£ 401. Ki·ªÉm tra: m·ªü app b·∫±ng WebApp button/StartParameter.');
  }

  try {
    const r = await fetch('/telebook/api/tg-bootstrap.php', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        // Tu·ª≥ backend, ƒë√¥i khi ti·ªán ƒë·ªçc t·ª´ header
        'X-Telegram-Init-Data': initData
      },
      body: JSON.stringify({ initData, user: unsafeUser })
    });

    let data = null;
    try { data = await r.json(); } catch (_) {
      console.error('[TG] Bootstrap: response kh√¥ng ph·∫£i JSON', r.status);
    }

    if (r.ok && data && data.ok) {
      // Token cho c√°c API sau
      localStorage.setItem('id_token', data.jwt || '');
      // L∆∞u th√™m th√¥ng tin ph·ª•
      sessionStorage.setItem('telebook_user_id', String(data.user_id || ''));
      sessionStorage.setItem('telebook_auth_time', String(Date.now()));
      console.log('[TG] Auth OK', data);
    } else {
      console.warn('[TG] Auth failed', { http: r.status, data });
      // N·∫øu 401 ‚Üí kh·∫£ nƒÉng initData kh√¥ng h·ª£p l·ªá/expired
      if (r.status === 401) {
        // G·ª£i √Ω UI: b√°o ng∆∞·ªùi d√πng m·ªü t·ª´ trong Telegram / reload
        window.showTelebookNotification?.('Kh√¥ng x√°c th·ª±c ƒë∆∞·ª£c v·ªõi Telegram. M·ªü t·ª´ b√™n trong Telegram ho·∫∑c th·ª≠ l·∫°i.', 'error');
      }
    }
  } catch (e) {
    console.error('[TG] Auth request error', e);
  }
})();
</script>


</head>

<body class="animation-level-2 has-auth-pages">
  <svg style="position: absolute; top: -10000px; left: -10000px;">
    <defs id="svg-defs">
      <!-- SVG defs gi·ªØ nguy√™n -->
      <clipPath id="tooltip-notch-clip">
        <path d="M19 7C16.8992 7 13.59 3.88897 11.5003 1.67424C10.7648 0.894688 10.397 0.50491 10.0434 0.385149C9.70568 0.270811 9.4225 0.270474 9.08456 0.38401C8.73059 0.50293 8.36133 0.892443 7.62279 1.67147C5.52303 3.88637 2.18302 7 0 7L19 7Z" />
      </clipPath>
      <clipPath id="message-tail-clip">
        <use href="#message-tail" />
      </clipPath>
      <path id="message-tail" d="M1.00002881,1.03679295e-14 L7,0 L7,17 C6.8069969,14.1607017 6.12380234,11.2332513 4.95041634,8.21764872 C4.04604748,5.89342034 2.50413132,3.73337411 0.324667862,1.73751004 L0.324652538,1.73752677 C-0.0826597201,1.36452676 -0.110475289,0.731958677 0.262524727,0.324646419 C0.451952959,0.117792698 0.719544377,1.0985861e-14 1.00002881,1.04360964e-14 Z" />
      <path id="logo" fill-rule="evenodd" d="M80,0 C124.18278,0 160,35.81722 160,80 C160,124.18278 124.18278,160 80,160 C35.81722,160 0,124.18278 0,80 C0,35.81722 35.81722,0 80,0 Z M114.262551,46.4516129 L114.123923,46.4516129 C111.089589,46.5056249 106.482806,48.0771432 85.1289541,56.93769 L81.4133571,58.4849956 C72.8664779,62.0684477 57.2607933,68.7965125 34.5963033,78.66919 C30.6591745,80.2345564 28.5967328,81.765936 28.4089783,83.2633288 C28.0626453,86.0254269 31.8703852,86.959903 36.7890378,88.5302703 L38.2642674,89.0045258 C42.3926354,90.314406 47.5534685,91.7248852 50.3250916,91.7847532 C52.9151948,91.8407003 55.7944784,90.8162976 58.9629426,88.7115451 L70.5121776,80.9327422 C85.6657026,70.7535853 93.6285785,65.5352892 94.4008055,65.277854 L94.6777873,65.216416 C95.1594319,65.1213105 95.7366278,65.0717596 96.1481181,65.4374337 C96.6344248,65.8695939 96.5866185,66.6880224 96.5351057,66.9075859 C96.127514,68.6448691 75.2839361,87.6143392 73.6629144,89.2417998 L73.312196,89.6016896 C68.7645143,94.2254793 63.9030972,97.1721503 71.5637945,102.355193 L73.3593638,103.544598 C79.0660342,107.334968 82.9483395,110.083813 88.8107882,113.958377 L90.3875424,114.996094 C95.0654739,118.061953 98.7330313,121.697601 103.562866,121.253237 C105.740839,121.052855 107.989107,119.042224 109.175465,113.09692 L109.246762,112.727987 C112.002037,98.0012935 117.417883,66.09303 118.669527,52.9443975 C118.779187,51.7924073 118.641237,50.318088 118.530455,49.6708963 L118.474159,49.3781963 C118.341081,48.7651315 118.067967,48.0040758 117.346762,47.4189793 C116.412565,46.6610871 115.002114,46.4638844 114.262551,46.4516129 Z" />
      <path id="poll-line" d="M4.47,5.33v13.6c0,4.97,4.03,9,9,9h458.16" />
      <path id="check" fill="none" d="M 4.7071 12.2929 l 5 5 c 0.3905 0.3905 1.0237 0.3905 1.4142 0 l 11 -11" />
      <path id="verified-icon-background" fill-rule="evenodd" clip-rule="evenodd" d="m14.378741 1.509638 1.818245 1.818557c.365651.365716.861601.571194 1.378741.571259l2.574273.000312c1.01361.000117 1.846494.773578 1.940861 1.762436l.008905.187798-.000312 2.5727c-.000065.517322.205439 1.013454.571259 1.379222l1.819649 1.819337c.714441.713427.759174 1.843179.134563 2.609139l-.134797.148109-1.819181 1.8182502c-.365963.3657823-.571558.8620196-.571493 1.3794456l.000312 2.5737972c.000559 1.0136048-.772668 1.846676-1.7615 1.9412861l-.188266.0084786-2.573792-.0003107c-.517426-.0000624-1.013675.2055248-1.379456.5714956l-1.818245 1.8191823c-.71331.7145515-1.843049.7594886-2.609113.1349998l-.148135-.1347645-1.8193435-1.8196542c-.3657628-.3658252-.8618987-.5713214-1.3792103-.571259l-2.5727052.0003107c-1.0136048.0001222-1.846676-.7731321-1.9412861-1.761968l-.0089492-.1877967-.0003107-2.5742678c-.0000624-.5171478-.2055495-1.0130926-.571259-1.3787397l-1.8185622-1.8182515c-.7139886-.713869-.758706-1.843647-.1340846-2.609607l.1338493-.148109 1.8190328-1.81935c.3655665-.365625.5709613-.861471.5710237-1.378494l.0003107-2.573181c.0006006-1.076777.8734635-1.949636 1.9502353-1.950234l2.5731758-.000312c.5170321-.000065 1.0128768-.205452 1.3785044-.571025l1.8193448-1.819038c.761592-.761449 1.996254-.761345 2.757716.000247zm3.195309 8.047806c-.426556-.34125-1.032655-.306293-1.417455.060333l-.099151.108173-4.448444 5.55815-1.7460313-1.74707-.1104961-.096564c-.4229264-.32188-1.0291801-.289692-1.4154413.096564-.3862612.386269-.4184492.992511-.0965653 1.41544l.0965653.1105 2.5999987 2.5999987.109876.0961467c.419874.320359 1.015131.2873897 1.397071-.0773773l.098579-.107692 5.2-6.4999961.083772-.120484c.273208-.455884.174278-1.054885-.252278-1.396122z" />
      <path id="verified-icon-check" d="M8 8H18V18H8V8Z" />
      <path id="topic-icon" d="M21.3733 4.27035C19.2176 2.25323 16.2016 1 12.8636 1C6.31153 1 1 5.82866 1 11.7851C1 15.1823 2.58685 17.9669 5.28707 19.9438C5.63238 20.1966 5.95042 21.6013 5.18073 22.7812C4.86598 23.2637 4.51948 23.639 4.25272 23.928C3.86715 24.3457 3.6482 24.5828 3.93266 24.7022C4.22935 24.8266 5.98245 24.8882 7.24776 24.1786C8.23812 23.6232 8.83793 23.0691 9.24187 22.696C9.57588 22.3875 9.77595 22.2027 9.95217 22.2431C10.584 22.388 11.236 22.4868 11.9035 22.5354C11.9126 22.5361 11.9218 22.5368 11.9309 22.5374C12.2386 22.5592 12.5497 22.5702 12.8636 22.5702C19.4157 22.5702 24.7273 17.7416 24.7273 11.7851C24.7273 8.86318 23.4491 6.21263 21.3733 4.27035Z" />
      <symbol id="message-tail-filled" viewBox="0 0 11 20">
        <g transform="translate(9 -14)" fill="inherit" fill-rule="evenodd">
          <path d="M-6 16h6v17c-.193-2.84-.876-5.767-2.05-8.782-.904-2.325-2.446-4.485-4.625-6.48A1 1 0 01-6 16z" transform="matrix(1 0 0 -1 0 49)" id="corner-fill" fill="inherit" />
        </g>
      </symbol>
      <symbol id="star-sparkle" viewBox="0 0 7 7">
        <path d="M3.49852 6.5C3.64328 6.5 3.75554 6.39655 3.77917 6.24581C4.04505 4.27438 4.31979 3.99655 6.23412 3.78374C6.38479 3.76601 6.5 3.64483 6.5 3.5C6.5 3.35222 6.38774 3.23399 6.23708 3.21626C4.3257 2.98867 4.06278 2.72266 3.77917 0.754187C3.75554 0.603448 3.64033 0.5 3.49852 0.5C3.35672 0.5 3.24151 0.603448 3.21787 0.754187C2.95199 2.72562 2.67725 3.00345 0.765879 3.21626C0.61226 3.23399 0.5 3.35222 0.5 3.5C0.5 3.64483 0.609306 3.76305 0.762925 3.78374C2.6743 4.04089 2.92541 4.27734 3.21787 6.24581C3.24446 6.39655 3.35968 6.5 3.49852 6.5Z" fill="currentColor" />
      </symbol>
      <linearGradient id="paint0_linear_6651_5783" x1="12.1999" y1="-1.71024" x2="12.1999" y2="25.2914" gradientUnits="userSpaceOnUse">
        <stop stop-color="#FFF0C2" />
        <stop offset="1" stop-color="#FFEBBA" />
      </linearGradient>
      <linearGradient id="paint1_linear_6651_5783" x1="12.1992" y1="-1.70952" x2="20.922" y2="24.9546" gradientUnits="userSpaceOnUse">
        <stop stop-color="#FFD147" />
        <stop offset="1" stop-color="#FFB526" />
      </linearGradient>
      <linearGradient id="paint2_linear_6651_5783" x1="12.1856" y1="1.51874" x2="16.8655" y2="22.0231" gradientUnits="userSpaceOnUse">
        <stop stop-color="#E58F0D" />
        <stop offset="1" stop-color="#EB7814" />
      </linearGradient>
    </defs>
  </svg>

  <div class="whole" id="auth-pages" style="display: none;">
    <div id="auth-pages-close" style="display: none;"></div>
    <div class="scrollable scrollable-y">
      <div class="tabs-container auth-pages__container" data-animation="tabs">
        <div class="tabs-tab page-signImport">
          <div class="container center-align"></div>
        </div>
        <div class="tabs-tab page-sign">
          <div class="container">
            <div class="auth-image">
              <svg class="sign-logo" xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">
                <use href="#logo" />
              </svg>
            </div>
          </div>
        </div>
        <div class="tabs-tab page-signQR">
          <div class="container center-align">
            <div class="auth-image"></div>
          </div>
        </div>
        <div class="tabs-tab page-authCode">
          <div class="container center-align">
            <div class="auth-image"></div>
            <div class="phone-wrapper">
              <h4 class="phone"></h4>
              <span class="phone-edit"></span>
            </div>
            <p class="subtitle sent-type"></p>
            <div class="input-wrapper"></div>
          </div>
        </div>
        <div class="tabs-tab page-password"></div>
        <div class="tabs-tab page-signUp"></div>
      </div>
    </div>
  </div>

  <div class="sidebar-left-overlay"></div>
  <div class="whole page-chats" style="display: none;" id="page-chats">
    <div id="main-columns" class="tabs-container" data-animation="navigation">
      <div class="folders-sidebar sidebar-left-common" id="folders-sidebar"></div>
      <div class="sidebar-left-placeholder"></div>
      <div class="tabs-tab chatlist-container sidebar sidebar-left main-column sidebar-left-common" id="column-left">
        <div class="sidebar-slider tabs-container">
          <div class="tabs-tab sidebar-slider-item item-main">
            <div class="sidebar-header main-search-sidebar-header can-have-forum">
              <div class="sidebar-header__btn-container">
                <div class="animated-menu-icon"></div>
                <div class="btn-icon sidebar-back-button"></div>
              </div>
            </div>
            <div class="sidebar-content transition zoom-fade can-have-forum">
              <div class="transition-item active" id="chatlist-container">
                <div class="folders-tabs-scrollable menu-horizontal-scrollable hide">
                  <nav class="menu-horizontal-div" id="folders-tabs"></nav>
                </div>
                <div class="tabs-container" id="folders-container"></div>
              </div>
              <div class="transition-item sidebar-search" id="search-container"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="tabs-tab main-column" id="column-center"></div>
      <div class="tabs-tab sidebar sidebar-right main-column" id="column-right">
        <div class="sidebar-content sidebar-slider tabs-container"></div>
      </div>
    </div>
  </div>

  

  <div id="stories-viewer"></div>
  <script src="src/index.ts" type="module"></script>
  <script src="/js/wallet-bridge.js"></script>
<script>
/** =============== Telegram WebApp Auth (C√°ch 1) =============== */
(async function ensureTelegramSession() {
  const tg = window.Telegram && window.Telegram.WebApp;
  if (!tg) {
    console.log('[TG] Outside Telegram ‚Äì skip auto-auth');
    return; // m·ªü ngo√†i Telegram th√¨ b·ªè qua
  }
  tg.ready(); tg.expand();

  try {
    const r = await fetch('/telebook/api/tg-bootstrap.php', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ initData: tg.initData || '' })
    });
    const data = await r.json();

    if (data && data.ok) {
      localStorage.setItem('id_token', data.jwt || '');
      sessionStorage.setItem('telebook_user_id', String(data.user_id || ''));
      console.log('[TG] Auth OK');
    } else {
      console.warn('[TG] Auth failed:', data?.error || 'unknown');
    }
  } catch (e) {
    console.error('[TG] Auth error', e);
  }
})();

/** ================== Helpers & API wrapper ================== */
window.telebook = {
  isWebApp: () => !!(window.Telegram && window.Telegram.WebApp),
  token: () => localStorage.getItem('id_token') || '',
  async api(path, {method='GET', headers={}, body=null} = {}) {
    const auth = this.token();
    const r = await fetch('/telebook/api/' + path, {
      method,
      headers: {
        'Authorization': auth ? ('Bearer ' + auth) : '',
        ...(body && !headers['Content-Type'] ? {'Content-Type':'application/json'} : {}),
        ...headers
      },
      body
    });
    // c·ªë g·∫Øng parse JSON; n·∫øu fail, n√©m l·ªói k√®m text
    const text = await r.text();
    try { return JSON.parse(text); } catch { throw new Error('Bad JSON: ' + text.slice(0,120)); }
  }
};

/** ============== UI helpers (toast + update wallet) ============== */
window.showTelebookNotification = (message, type='info') => {
  const n = document.createElement('div');
  n.style.cssText = `
    position: fixed; top: 80px; right: 20px; z-index: 10001;
    background: ${type==='success'?'#4CAF50':type==='error'?'#f44336':'#2196F3'};
    color:#fff;padding:14px 16px;border-radius:10px;font-weight:600;
    transform: translateX(400px); transition: transform .3s ease; max-width:320px; font-size:14px;
  `;
  n.textContent = message; document.body.appendChild(n);
  requestAnimationFrame(()=> n.style.transform='translateX(0)');
  setTimeout(()=>{ n.style.transform='translateX(400px)'; setTimeout(()=>n.remove(),300); }, 3500);
};

window.telebookWalletUpdate = (profile) => {
  const vnd = new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'});
  document.querySelectorAll('[id*="balance"], .balance-display, .wallet-balance')
    .forEach(el => el.textContent = vnd.format(profile.balance ?? 0));
  document.querySelectorAll('.user-name, .user-info')
    .forEach(el => el.textContent = `${profile.name || profile.first_name || ''}`.trim());
  // ·∫©n c√°c kh·ªëi y√™u c·∫ßu auth n·∫øu c√≥
  document.querySelectorAll('.telegram-auth-card, .auth-section, .wallet-auth, .telegram-auth')
    .forEach(el => el.style.display = 'none');
  document.querySelectorAll('.auth-required').forEach(el => el.style.display='block');
};

/** ============== App bootstrap ============== */
document.addEventListener('DOMContentLoaded', async () => {
  console.log('üí≥ Telebook bootstrap');

  // N·∫øu ƒëang ·ªü Telegram & ƒë√£ c√≥ token ‚Üí n·∫°p profile
  const inTG = window.telebook.isWebApp();
  const token = window.telebook.token();

  if (inTG && token) {
    try {
      // G·ªçi API l·∫•y h·ªì s∆°/s·ªë d∆∞ theo user_id trong JWT
      const res = await window.telebook.api('profile-data.php');
      if (res.ok && res.data) {
        window.telebookWalletUpdate(res.data);
        setTimeout(()=> window.showTelebookNotification('üéâ Ch√†o m·ª´ng quay l·∫°i!', 'success'), 800);
      } else if (res.error === 'NOT_LOGGED_IN') {
        console.warn('NOT_LOGGED_IN ‚Äì ch·ªù tg-bootstrap t·∫°o session');
      }
    } catch (e) {
      console.error('Profile load error:', e);
    }
  } else {
    // ngo√†i Telegram ‚Üí hi·ªÉn th·ªã g·ª£i √Ω m·ªü trong Telegram (n·∫øu mu·ªën)
    console.log('üåê Browser mode ‚Äì show ‚ÄúOpen in Telegram‚Äù hint if needed');
  }

  // (Tu·ª≥ ch·ªçn) Poll nh·∫π ƒë·ªÉ c·∫≠p nh·∫≠t s·ªë d∆∞
  setInterval(async () => {
    const token = window.telebook.token();
    if (!token) return;
    try {
      const res = await window.telebook.api('profile-data.php');
      if (res.ok && res.data) window.telebookWalletUpdate(res.data);
    } catch {}
  }, 30000);
});
</script>

</body>

</html>